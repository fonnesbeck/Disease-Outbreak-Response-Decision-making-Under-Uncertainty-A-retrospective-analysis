\appendix

\section{Python model}

The full model used to obtain estimates for this manuscript is available as a Jupyter notebook:

\verb|https://goo.gl/EowM1u|

The notebook includes all data preparation steps, the full PyMC model, and diagnostic outputs.

\section{Sensitivity analyses}

\textbf{Removal of excess susceptible pool}

A major assumption of our model is the existence of a pool of excess susceptibles, perhaps the result of migrant influxes from other regions of Brazil that did not receive the same historical immunization regime. To assess the effect of this component on the fit of the model and the resulting estimates, we modularized the model to remove the availability of this population by setting a flag in the model code. This flag results in the infection process being generated entirely from the local susceptible population, rather than as a mixture of local and excess infections.

The estimated $R_0$ value under this model was 56 (95 \% BCI = [53, 59]), which is much higher than typical reproduction numbers for measles\cite{Durrheim_2014}. Hence, assuming a large number of excess susceptible adult individuals appears to be important in the development of a model with reasonable fit.

\textbf{Uncertainty in population immunity}

Our model uses historical records of routine vaccination, supplemental immunization and likely natural exposure to estimate immunity in the population in 1996. Each of these sources of immunity are entered into the model without associated estimates of uncertainty in their values, and hence the product of these sources of immunity are determinstically multiplied together to yield a value for the probability of susceptibility that is then used in a binomial model to estimate the number of susceptibles in the population at the start of the outbreak. Thus, the only source of uncertainty in the size of the susceptible population in the model is that associated with the binomial sampling process.

To evaluate the effect of assuming known values for historical immunity, we ran a modified model that allocated epistemic uncertainty to the routine vaccination coverage and to supplemental vaccination campaigns. For the former, the historic data were used to specify shape and scale parameters of a beta distribution for each year (1980-1996), which were used as priors for the coverage during that year. The range of priors is shown in Figure A1.